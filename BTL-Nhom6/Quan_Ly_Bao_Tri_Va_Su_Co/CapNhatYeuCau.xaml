<Window x:Class="BTL_Nhom6.Quan_Ly_Bao_Tri_Va_Su_Co.CapNhatYeuCau"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="Cập nhật yêu cầu" Height="762" Width="550"
        WindowStartupLocation="CenterScreen" ResizeMode="NoResize" WindowStyle="None"
        Background="{StaticResource ContentBackgroundBrush}" AllowsTransparency="True"
        TextElement.Foreground="{StaticResource TextPrimaryBrush}"
        FontFamily="{DynamicResource MaterialDesignFont}">

    <Border CornerRadius="12" BorderBrush="{StaticResource BorderLightBrush}" BorderThickness="1" 
            Background="{StaticResource ContentBackgroundBrush}" MouseLeftButtonDown="Border_MouseLeftButtonDown">
        <Border.Effect>
            <DropShadowEffect BlurRadius="20" ShadowDepth="5" Opacity="0.2" Direction="270"/>
        </Border.Effect>
        <Grid Margin="32">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <TextBlock Grid.Row="0" Text="CẬP NHẬT YÊU CẦU" FontSize="24" FontWeight="Bold" 
                       Foreground="{StaticResource PrimaryBlueBrush}" HorizontalAlignment="Center" Margin="0,0,0,24"/>

            <StackPanel Grid.Row="1">
                <!-- 1. Thông tin Readonly -->
                <TextBlock Text="Thiết bị:" FontWeight="SemiBold" Margin="0,0,0,4"/>
                <TextBox x:Name="txtThietBi" IsReadOnly="True" Background="#F3F4F6" Style="{StaticResource MaterialDesignOutlinedTextBox}" Margin="0,0,0,16"/>

                <TextBlock Text="Người yêu cầu:" FontWeight="SemiBold" Margin="0,0,0,4"/>
                <TextBox x:Name="txtNguoiYeuCau" IsReadOnly="True" Background="#F3F4F6" Style="{StaticResource MaterialDesignOutlinedTextBox}" Margin="0,0,0,16"/>

                <!-- 2. Mức ưu tiên (Cho phép sửa) -->
                <TextBlock Text="Mức độ ưu tiên:" FontWeight="SemiBold" Margin="0,0,0,4"/>
                <ComboBox x:Name="cboMucUuTien" Style="{StaticResource MaterialDesignOutlinedComboBox}" Height="50" Margin="0,0,0,16">
                    <ComboBoxItem Content="Low (Thấp)" Tag="Low"/>
                    <ComboBoxItem Content="Medium (Trung bình)" Tag="Medium"/>
                    <ComboBoxItem Content="High (Cao)" Tag="High"/>
                    <ComboBoxItem Content="Critical (Khẩn cấp)" Tag="Critical"/>
                </ComboBox>

                <!-- 3. Trạng thái (QUAN TRỌNG: Admin dùng để Duyệt) -->
                <TextBlock Text="Trạng thái xử lý:" FontWeight="SemiBold" Margin="0,0,0,4" Foreground="{StaticResource PrimaryBlueBrush}"/>
                <ComboBox x:Name="cboTrangThai" Style="{StaticResource MaterialDesignOutlinedComboBox}" Height="50" Margin="0,0,0,16" FontWeight="Bold">
                    <ComboBoxItem Content="Đang chờ xử lý" Tag="Pending"/>
                    <ComboBoxItem Content="Đang thực hiện (Duyệt)" Tag="Approved"/>
                    <ComboBoxItem Content="Hoàn thành" Tag="Completed"/>
                    <ComboBoxItem Content="Từ chối" Tag="Rejected"/>
                </ComboBox>

                <!-- 4. Mô tả lỗi -->
                <TextBlock Text="Mô tả sự cố:" FontWeight="SemiBold" Margin="0,0,0,4"/>
                <TextBox x:Name="txtMoTa" Style="{StaticResource MaterialDesignOutlinedTextBox}"
                         Height="100" TextWrapping="Wrap" AcceptsReturn="True" 
                         VerticalContentAlignment="Top" Margin="0,0,0,16"/>
                <!-- 5. DANH SÁCH ẢNH MINH CHỨNG -->
                <TextBlock Text="Hình ảnh minh chứng:" FontWeight="SemiBold" Margin="0,10,0,4"/>

                <Border BorderBrush="{StaticResource BorderLightBrush}" BorderThickness="1" CornerRadius="4" 
        Background="#FAFAFA" MinHeight="100" Padding="8">
                    <ScrollViewer VerticalScrollBarVisibility="Disabled" HorizontalScrollBarVisibility="Auto">
                        <ItemsControl x:Name="icImages">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel Orientation="Horizontal"/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Margin="0,0,10,0" CornerRadius="4" BorderBrush="Gray" BorderThickness="1" ClipToBounds="True"
                Cursor="Hand"
                MouseLeftButtonUp="Image_MouseLeftButtonUp">

                                        <Image Source="{Binding ImageUrl}" Width="80" Height="80" Stretch="UniformToFill" 
                   ToolTip="Bấm để xem ảnh lớn"/>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Border>
                <TextBlock x:Name="lblNoImage" Text="Không có ảnh đính kèm" FontStyle="Italic" Foreground="Gray" Visibility="Collapsed" Margin="4,4,0,0"/>
            </StackPanel>

            <Grid Grid.Row="2" Margin="0,24,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="16"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Button Grid.Column="0" Content="Đóng" IsCancel="True" Click="BtnHuy_Click" 
                        Style="{StaticResource MaterialDesignOutlinedButton}" BorderBrush="{StaticResource BorderMediumBrush}" Foreground="{StaticResource TextSecondaryBrush}"/>
                <Button Grid.Column="1" Grid.ColumnSpan="2" Content="LƯU CẬP NHẬT" Click="BtnLuu_Click" 
                        Background="{StaticResource PrimaryBlueBrush}" BorderBrush="{StaticResource PrimaryBlueBrush}" Foreground="White" FontWeight="Bold"/>
            </Grid>
        </Grid>
    </Border>
</Window>